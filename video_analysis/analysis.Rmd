---
title: "Stimuli Analysis"
output: html_document
date: '2022-02-25'
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r message=FALSE, warning=FALSE}
library(Rtsne)
library(tidyverse)
library(easystats)


df <- read.csv("data_objective.csv") |> 
  mutate(Typology = ifelse(str_detect(File, "City"), "City", "Green"))

# Remove duplicates
df <- df[!duplicated(select(df, -File, -Typology)), ] 
```


## t-SNE

Applying t-Distributed Stochastic Neighbor Embedding (t-SNE).


```{r message=FALSE, warning=FALSE}
rez <- df |> 
  select(RedGreen, BlueYellow , Colorfulness, Contrast, Saturation, 
         Entropy, Brightness, Luminance_Perceived, Faces) |> 
  scale() |> 
  Rtsne(dims = 3, perplexity = 30)  %>%
  .$Y |> 
  as.data.frame() %>%
  data_rename(paste0("tSNE_", 1:ncol(.))) |> 
  cbind(df)

labels <- rez[rez$tSNE_1 < -10 | rez$tSNE_1 > 13.5, ]

# 3D scatter
# library(plotly)
# plot_ly(rez, x = ~tSNE_1, y = ~tSNE_2, z=~tSNE_3, 
#         color=~Typology, symbol = ~Typology,
#         type="scatter3d", mode="markers",
#         colors = c("red", "green")))

rez |> 
  ggplot(aes(x = tSNE_1, y = tSNE_2)) +
  geom_point(aes(shape = Typology, color = tSNE_3)) +
  ggrepel::geom_text_repel(aes(label=File), ) +
  scale_color_viridis_c(guide = "none") +
  theme_void()
```


## Stimuli

```{r message=FALSE, warning=FALSE}
select(df, -File)
```
